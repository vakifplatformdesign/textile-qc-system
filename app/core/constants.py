"""Scientific constants for color analysis."""

import numpy as np

# White Points (Illuminants) - CIE Standard
WHITE_POINTS = {
    "D65": np.array([95.047, 100.000, 108.883]),
    "D50": np.array([96.422, 100.000, 82.521]),
    "TL84": np.array([101.385, 100.000, 65.231]),  # F11/TL84
    "A":   np.array([109.850, 100.000, 35.585]),
    "F2":  np.array([99.187, 100.000, 67.395]),  # Cool White Fluorescent
    "CWF": np.array([103.280, 100.000, 69.026]),  # Cool White Fluorescent
    "F7":  np.array([95.044, 100.000, 108.755]),  # Daylight Fluorescent
    "F11": np.array([100.966, 100.000, 64.370]),  # TL84 equivalent
}

# Bradford Chromatic Adaptation Transform Matrix
M_BRADFORD = np.array([[ 0.8951,  0.2664, -0.1614],
                       [-0.7502,  1.7135,  0.0367],
                       [ 0.0389, -0.0685,  1.0296]])
M_BRADFORD_INV = np.linalg.inv(M_BRADFORD)

# CIE 1931 2° Standard Observer Wavelengths (380-780nm, 5nm step)
CIE_2DEG_WAVELENGTHS = np.arange(380, 781, 5)

# CIE 1931 2° Color Matching Functions
CIE_2DEG_CMF = {
    'x_bar': np.array([0.001368, 0.004243, 0.014310, 0.043510, 0.134380, 0.283900, 0.348280, 0.336200, 0.290800, 0.195360,
                       0.095640, 0.032010, 0.004900, 0.009300, 0.063270, 0.165500, 0.290400, 0.433450, 0.594500, 0.762100,
                       0.916300, 1.026300, 1.062200, 1.002600, 0.854450, 0.642400, 0.447900, 0.283500, 0.164900, 0.087400,
                       0.046770, 0.022700, 0.011359, 0.005790, 0.002899, 0.001440, 0.000690, 0.000332, 0.000166, 0.000083,
                       0.000042, 0.000021, 0.000010, 0.000005, 0.000003, 0.000001, 0.000001, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000]),
    'y_bar': np.array([0.000039, 0.000120, 0.000396, 0.001210, 0.004000, 0.011600, 0.023000, 0.038000, 0.060000, 0.090980,
                       0.139020, 0.208020, 0.323000, 0.503000, 0.710000, 0.862000, 0.954000, 0.994950, 0.995000, 0.952000,
                       0.870000, 0.757000, 0.631000, 0.503000, 0.381000, 0.265000, 0.175000, 0.107000, 0.061000, 0.032000,
                       0.017000, 0.008210, 0.004102, 0.002091, 0.001047, 0.000520, 0.000249, 0.000120, 0.000060, 0.000030,
                       0.000015, 0.000007, 0.000004, 0.000002, 0.000001, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000]),
    'z_bar': np.array([0.006450, 0.020050, 0.067850, 0.207400, 0.645600, 1.385600, 1.747060, 1.772110, 1.669200, 1.287640,
                       0.812950, 0.465180, 0.272000, 0.158200, 0.078250, 0.042160, 0.020300, 0.008750, 0.003900, 0.002100,
                       0.001650, 0.001100, 0.000800, 0.000340, 0.000190, 0.000050, 0.000020, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000,
                       0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000])
}

# D65 Illuminant Spectral Power Distribution (380-780nm, 5nm step)
D65_SPD = np.array([49.98, 52.31, 54.65, 68.70, 82.75, 87.12, 91.49, 92.46, 93.43, 90.06,
                    86.68, 95.77, 104.86, 110.94, 117.01, 117.41, 117.81, 116.34, 114.86, 115.39,
                    115.92, 112.37, 108.81, 109.08, 109.35, 108.58, 107.80, 106.30, 104.79, 106.24,
                    107.69, 106.05, 104.41, 104.23, 104.05, 102.02, 100.00, 98.17, 96.33, 96.06,
                    95.79, 92.24, 88.69, 89.35, 90.01, 89.80, 89.60, 88.65, 87.70, 85.49,
                    83.29, 83.49, 83.70, 81.86, 80.03, 80.12, 80.21, 81.25, 82.28, 80.28,
                    78.28, 74.00, 69.72, 70.67, 71.61, 72.98, 74.35, 67.98, 61.60, 65.74,
                    69.89, 72.49, 75.09, 69.34, 63.59, 55.01, 46.42, 56.61, 66.81, 65.09, 63.38])

